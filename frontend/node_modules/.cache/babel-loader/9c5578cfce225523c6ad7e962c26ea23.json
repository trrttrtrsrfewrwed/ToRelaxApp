{"ast":null,"code":"let current_data = {\n  user: {\n    login: \"\",\n    email: \"\"\n  },\n  password: \"\"\n};\nlet data = [{\n  user: {\n    login: \"trrttrtrsrfewrwed\",\n    email: \"nurgaliev.tr@phystech.edu\"\n  },\n  password: \"qwerty\"\n}];\n\nfunction resolveAfter2Seconds(x) {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      resolve(x);\n    }, 2000);\n  });\n}\n\nfunction rejectAfter1Second(error) {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      reject(error);\n    }, 1000);\n  });\n}\n\nasync function addUser(user, password) {\n  if (data.find(elem => {\n    return elem.user.email == user.email;\n  }) == null) {\n    console.log(\"addUser OK\");\n    const unused = await resolveAfter2Seconds(42);\n    data.push({\n      user: user,\n      password: password\n    });\n    current_data = {\n      user: user,\n      password: password\n    };\n    return current_data;\n  } else {\n    console.log(\"addUser REJECT\");\n    return rejectAfter1Second(\"user with such email already exists\");\n  }\n}\n\nasync function enter(email, password) {\n  let find_result = data.find(elem => {\n    return elem.user.email == email && elem.user.password == password;\n  });\n\n  if (find_result == null) {\n    console.log(\"enter REJECT\");\n    const unused = await rejectAfter1Second(\"incorrect email or password\");\n  } else {\n    console.log(\"enter OK\");\n    const unused = await resolveAfter2Seconds(42);\n    current_data = find_result;\n    return current_data;\n  }\n}\n\nasync function lout() {\n  console.log(\"logout\");\n  const unused = await resolveAfter2Seconds(42);\n  current_data = {\n    user: {\n      login: \"\",\n      email: \"\"\n    },\n    password: \"\"\n  };\n  return null;\n}\n\nasync function cUser() {\n  if (current_data.user === \"\") {\n    console.log(\"currentUser REJECT\");\n    const unused = await rejectAfter1Second(\"you need to log in first\");\n  } else {\n    console.log(\"currentUser OK\");\n    const unused = await resolveAfter2Seconds(42);\n    return current_data;\n  }\n}\n\nconst UserService = {\n  signup(user, password) {\n    return addUser(user, password); //return http('signup', 'POST', {user, password})\n  },\n\n  login(email, password) {\n    console.log('login');\n    return enter(email, password); //return http('signin', 'POST', {email, password})\n  },\n\n  logout() {\n    return lout(); //return http('signout', 'DELETE')\n  },\n\n  currentUser() {\n    return cUser(); //return http('currentUser', 'GET')\n  }\n\n};\nexport default UserService;","map":{"version":3,"sources":["/home/mr_tross/Fullstack/torelax/src/userService/index.js"],"names":["current_data","user","login","email","password","data","resolveAfter2Seconds","x","Promise","resolve","setTimeout","rejectAfter1Second","error","reject","addUser","find","elem","console","log","unused","push","enter","find_result","lout","cUser","UserService","signup","logout","currentUser"],"mappings":"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","sourcesContent":["\nlet current_data = {\n    user: {login: \"\", email: \"\"},\n    password: \"\"\n}\n\nlet data = [\n    {user: {login: \"trrttrtrsrfewrwed\", email: \"nurgaliev.tr@phystech.edu\"},\n     password: \"qwerty\"}\n]\n\nfunction resolveAfter2Seconds(x) {\n    return new Promise(resolve => {\n      setTimeout(() => {\n        resolve(x);\n      }, 2000);\n    });\n}\n\nfunction rejectAfter1Second(error) {\n    return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          reject(error);\n        }, 1000);\n      });\n}\n\nasync function addUser(user, password) {\n    if (data.find((elem) => { return elem.user.email == user.email}) == null) {\n        console.log(\"addUser OK\")\n        const unused = await resolveAfter2Seconds(42)\n        data.push({user: user, password: password})\n        current_data = {user: user, password: password}\n        return current_data\n    } else {\n        console.log(\"addUser REJECT\")\n        return rejectAfter1Second(\"user with such email already exists\")\n    }   \n} \n\nasync function enter(email, password) {\n    let find_result = data.find((elem) => { return elem.user.email == email && elem.user.password == password})\n    if (find_result == null) {\n        console.log(\"enter REJECT\")\n        const unused = await rejectAfter1Second(\"incorrect email or password\")\n    } else {\n        console.log(\"enter OK\")\n        const unused = await resolveAfter2Seconds(42)\n        current_data = find_result\n        return current_data\n    }   \n} \n\nasync function lout() {\n    console.log(\"logout\")\n    const unused = await resolveAfter2Seconds(42)\n    current_data = {\n        user: {login: \"\", email: \"\"},\n        password: \"\"\n    }\n    return null;\n}\n\nasync function cUser() {\n    if (current_data.user === \"\") {\n        console.log(\"currentUser REJECT\")\n        const unused = await rejectAfter1Second(\"you need to log in first\")\n    } else {\n        console.log(\"currentUser OK\")\n        const unused = await resolveAfter2Seconds(42)\n        return current_data;\n    }\n}\n\nconst UserService = {\n  signup(user, password) {\n    return addUser(user, password)\n    //return http('signup', 'POST', {user, password})\n  },\n  login(email, password) {\n    console.log('login');\n    return enter(email, password)\n    //return http('signin', 'POST', {email, password})\n  },\n  logout() {\n      return lout()\n    //return http('signout', 'DELETE')\n  },\n  currentUser() {\n      return cUser()\n    //return http('currentUser', 'GET')\n  }\n};\n\nexport default UserService;"]},"metadata":{},"sourceType":"module"}